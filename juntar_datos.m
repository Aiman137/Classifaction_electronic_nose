close all
clc 
clear

% Cargamos el archivo csv
filename = 'putty_Arduino_DataDEF.csv';
data = readtable(filename);

% Buscamos la filas vacias y las eliminamos
empty_rows1 = all(ismissing(data), 2);
data(empty_rows1, :) = [];

new_filename = 'cleaned_putty_Arduino_DataDEF.csv';
writetable(data, new_filename);
M1 = readmatrix('cleaned_putty_Arduino_DataDEF.csv');
%disp(data);

% Cargamos otros datos
data2 = readtable('putty_sensors_data2.csv');

% Buscamos la filas vacias y las eliminamos
empty_rows2 = all(ismissing(data2), 2);
data2(empty_rows2, :) = [];

writetable(data2, 'cleaned_data2.csv');
M2 = readmatrix('cleaned_data2.csv');

figure(1),
plot(data2{2:end, 1});
hold on
plot(data2{2:end, 2});
hold on
plot(data2{2:end, 3});

% Cargamos otros datos
data3 = readtable('putty_sensors_data3.csv');

% Buscamos la filas vacias y las eliminamos
empty_rows3 = all(ismissing(data3), 2);
data3(empty_rows3, :) = [];

writetable(data3, 'cleaned_data2.csv');
M3 = readmatrix('cleaned_data2.csv');

figure(2),
plot(data3{2:end, 1});
hold on
plot(data3{2:end, 2});
hold on
plot(data3{2:end, 3});





figure(3),
plot(data{2:end, 1});
hold on
plot(data{2:end, 2});
hold on
plot(data{2:end, 3});
xline(6280); %%
xline(11380); %%

xline(16560); %%
xline(21660); %%

xline(24305); %%
xline(29405); %%

xline(34300); %%
xline(39400); %%

xline(42045); %%
xline(47145); %%


xline(51850); %%
xline(56950);

xline(59600);
xline(64700);


data_sensors = [M1(6280:11380,1)' M1(6280:11380,2)' M1(6280:11380,3)';
    M1(16560:21660,1)' M1(16560:21660,2)' M1(16560:21660,3)';
    M1(24305:29405,1)' M1(24305:29405,2)' M1(24305:29405,3)';
    M1(34300:39400,1)' M1(34300:39400,2)' M1(34300:39400,3)';
    M1(42045:47145,1)' M1(42045:47145,2)' M1(42045:47145,3)';
    M1(51850:56950,1)' M1(51850:56950,2)' M1(51850:56950,3)';
    M1(59600:64700,1)' M1(59600:64700,2)' M1(59600:64700,3)';];

y = [1 0 1 0 1 0 1];

[U, Z] = pca(data_sensors, 'NumComponents', 3);
figure(4),
scatter(Z(:,1), Z(:,2), 25, y,'filled');


% Cargamos datos 4
% Cargamos el archivo csv
filename4 = 'putty_sensors_data4.csv';
data4 = readtable(filename4);

% Buscamos la filas vacias y las eliminamos
empty_rows1 = all(ismissing(data), 2);
data(empty_rows1, :) = [];

new_filename4 = 'cleaned_putty_Arduino_Data4.csv';
writetable(data4, new_filename4);
M4 = readmatrix('cleaned_putty_Arduino_Data4.csv');

figure(5),
plot(data4{2:end, 1});
hold on
plot(data4{2:end, 2});
hold on
plot(data4{2:end, 3});

xline(6100); %%
xline(12600+3400); %%

xline(16415); %%
xline(22915+3400); %%
 
 
xline(36760); %%
xline(43260+3400); %%
 
xline(47160); %%
xline(57060); %%

xline(67280); %%
xline(73780+3400); %%

xline(77450); %%
xline(83950+3400); %%

xline(97500); %%
xline(104000+3400); %%

xline(107415); %%
xline(113915+3400); %%

xline(125500); %%
xline(132000+3400); %%

xline(135200); %%
xline(141700+3400); %%

xline(155700); %%
xline(162200+3400); %%

xline(165780); %%
xline(172280+3400); %%

xline(185900); %%
xline(192400+3400); %%

xline(195900); %%
xline(202400+3400); %%

xline(216280); %%
xline(222780+3400); %%

xline(226450); %%
xline(232950+3400); %%

xline(244000); %%
xline(250500+3400); %%

xline(254180); %%
xline(260680+3400); %%

xline(274500); %%
xline(281000+3400); %%

xline(284450); %%
xline(290950+3400); %%

xline(304440); %%
xline(310940+3400); %%

xline(314750); %%
xline(321250+3400); %%

xline(334960); %%
xline(341460+3400); %%

xline(345065);
xline(351565+3400);

data_sensors4 = [M4(6100:16000,1)' M4(6100:16000,2)' M4(6100:16000,3)'; %% 9900 -- 1 
    M4(16415:26315,1)' M4(16415:26315,2)' M4(16415:26315,3)'; %% 9900 -- 0
    M4(36760:46660,1)' M4(36760:46660,2)' M4(36760:46660,3)'; %% 9900 -- 1
    M4(47160:57060,1)' M4(47160:57060,2)' M4(47160:57060,3)'; %% 9900 -- 0
    M4(67280:77180,1)' M4(67280:77180,2)' M4(67280:77180,3)'; %% 9900 -- 1
    M4(77450:87350,1)' M4(77450:87350,2)' M4(77450:87350,3)'; %% 9900 -- 0
    M4(97500:107400,1)' M4(97500:107400,2)' M4(97500:107400,3)'; %% 9900 -- 1
    M4(107415:117315,1)' M4(107415:117315,2)' M4(107415:117315,3)'; %% 9900 -- 0
    M4(125500:135400,1)' M4(125500:135400,2)' M4(125500:135400,3)'; %% 9900 -- 1
    M4(135200:145100,1)' M4(135200:145100,2)' M4(135200:145100,3)'; %% 9900 -- 0
    M4(165780:175680,1)' M4(165780:175680,2)' M4(165780:175680,3)'; %% 9900 -- 1
    M4(185900:195800,1)' M4(185900:195800,2)' M4(185900:195800,3)'; %% 9900 -- 0
    M4(195900:205800,1)' M4(195900:205800,2)' M4(195900:205800,3)'; %% 9900 -- 1
    M4(216280:226180,1)' M4(216280:226180,2)' M4(216280:226180,3)'; %% 9900 -- 0
    M4(226450:236350,1)' M4(226450:236350,2)' M4(226450:236350,3)'; %% 9900 -- 1
    M4(244000:253900,1)' M4(244000:253900,2)' M4(244000:253900,3)'; %% 9900 -- 0
    M4(254180:264080,1)' M4(254180:264080,2)' M4(254180:264080,3)'; %% 9900 -- 1 
    M4(274500:284400,1)' M4(274500:284400,2)' M4(274500:284400,3)'; %% 9900 -- 0
    M4(284450:294350,1)' M4(284450:294350,2)' M4(284450:294350,3)'; %% 9900 -- 1
    M4(304440:314340,1)' M4(304440:314340,2)' M4(304440:314340,3)'; %% 9900 -- 0
    M4(314750:324650,1)' M4(314750:324650,2)' M4(314750:324650,3)'; %% 9900 -- 1
    M4(334960:344860,1)' M4(334960:344860,2)' M4(334960:344860,3)'; %% 9900 -- 0
    M4(345065:354965,1)' M4(345065:354965,2)' M4(345065:354965,3)';]; %% 9900 1

y4 = [1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1];

[U4, Z4] = pca(data_sensors4, 'NumComponents', 2);
Y4 = tsne(data_sensors4);
%%Y44 = cmdscale(data_sensors4);
figure(6),
%%plot(Y44(:,1), Y44(:,2))
%gscatter(Y4(:,1),Y4(:,2),y4)
scatter(Z4(:,1), Z4(:,2), 25, y4,'filled');


% Cargamos datos 5
% Cargamos el archivo csv
filename5 = 'putty_sensors_data5.csv';
data5 = readtable(filename5);

% Buscamos la filas vacias y las eliminamos
empty_rows5 = all(ismissing(data5), 2);
data5(empty_rows5, :) = [];

new_filename5 = 'cleaned_putty_Arduino_Data5.csv';
writetable(data5, new_filename5);
M5 = readmatrix('cleaned_putty_Arduino_Data5.csv');

figure(7),
plot(data5{2:end, 1});
hold on
plot(data5{2:end, 2});
hold on
plot(data5{2:end, 3});

xline(6100); %%
xline(11200); %%

xline(16000); %%
xline(21100); %%

xline(24050); %%
xline(29150); %%

xline(34100); %%
xline(39200); %%

xline(41500); %%
xline(46600); %%

xline(51850); %%
xline(56950); %%

xline(59250); %%
xline(64350); %%

xline(69350); %%
xline(74450); %%

xline(95150); %%
xline(100250); %%

xline(105120); %%
xline(110220); %%

xline(112750); %%
xline(117850); %%

xline(123000); %%
xline(128100); %%

xline(130950); %%
xline(136050); %%

xline(140740); %%
xline(145840); %%

xline(148150);
xline(153250);

xline(158200);
xline(163300);

data_sensors5 = [ %%
    M5(16000:21100,1)' M5(16000:21100,2)' M5(16000:21100,3)'; %% XX
     %%
    M5(34100:39200,1)' M5(34100:39200,2)' M5(34100:39200,3)'; %%
    M5(41500:46600,1)' M5(41500:46600,2)' M5(41500:46600,3)'; %%
    M5(51850:56950,1)' M5(51850:56950,2)' M5(51850:56950,3)'; %%
    M5(59250:64350,1)' M5(59250:64350,2)' M5(59250:64350,3)'; %%
    M5(69350:74450,1)' M5(69350:74450,2)' M5(69350:74450,3)'; %%
    M5(95150:100250,1)' M5(95150:100250,2)' M5(95150:100250,3)'; %%
    M5(105120:110220,1)' M5(105120:110220,2)' M5(105120:110220,3)'; %%
    M5(112750:117850,1)' M5(112750:117850,2)' M5(112750:117850,3)'; %%
    M5(123000:128100,1)' M5(123000:128100,2)' M5(123000:128100,3)'; %%
     %%
    M5(140740:145840,1)' M5(140740:145840,2)' M5(140740:145840,3)'; %%
    M5(148150:153250,1)' M5(148150:153250,2)' M5(148150:153250,3)'; %%
    M5(158200:163300,1)' M5(158200:163300,2)' M5(158200:163300,3)';];

y5 = [0 0 1 0 1 0 1 0 1 0 0 1 0];

[U5, Z5] = pca(data_sensors5, 'NumComponents', 2);
figure(8),
scatter(Z5(:,1), Z5(:,2), 25, y5,'filled');

data_sensors45 = [M1(6280:11380,1)' M1(6280:11380,2)' M1(6280:11380,3)';
    M1(16560:21660,1)' M1(16560:21660,2)' M1(16560:21660,3)';
    M1(24305:29405,1)' M1(24305:29405,2)' M1(24305:29405,3)';
    M1(34300:39400,1)' M1(34300:39400,2)' M1(34300:39400,3)';
    M1(42045:47145,1)' M1(42045:47145,2)' M1(42045:47145,3)';
    M1(51850:56950,1)' M1(51850:56950,2)' M1(51850:56950,3)';
    M1(59600:64700,1)' M1(59600:64700,2)' M1(59600:64700,3)';
    M5(6100:11200,1)' M5(6100:11200,2)' M5(6100:11200,3)'; %%
    M5(16000:21100,1)' M5(16000:21100,2)' M5(16000:21100,3)'; %% XX
    M5(24050:29150,1)' M5(24050:29150,2)' M5(24050:29150,3)'; %%
    M5(34100:39200,1)' M5(34100:39200,2)' M5(34100:39200,3)'; %%
    M5(41500:46600,1)' M5(41500:46600,2)' M5(41500:46600,3)'; %%
    M5(51850:56950,1)' M5(51850:56950,2)' M5(51850:56950,3)'; %%
    M5(59250:64350,1)' M5(59250:64350,2)' M5(59250:64350,3)'; %%
    M5(69350:74450,1)' M5(69350:74450,2)' M5(69350:74450,3)'; %%
    M5(95150:100250,1)' M5(95150:100250,2)' M5(95150:100250,3)'; %%
    M5(105120:110220,1)' M5(105120:110220,2)' M5(105120:110220,3)'; %%
    M5(112750:117850,1)' M5(112750:117850,2)' M5(112750:117850,3)'; %%
    M5(123000:128100,1)' M5(123000:128100,2)' M5(123000:128100,3)'; %%
    M5(130950:136050,1)' M5(130950:136050,2)' M5(130950:136050,3)'; %%
    M5(140740:145840,1)' M5(140740:145840,2)' M5(140740:145840,3)'; %%
    M5(148150:153250,1)' M5(148150:153250,2)' M5(148150:153250,3)'; %%
    M5(158200:163300,1)' M5(158200:163300,2)' M5(158200:163300,3)';];

y45 = [1 0 1 0 1 0 1 1 0 1 0 1 0 1 0 1 0 1 0 1 0 1 0];

[U45, Z45] = pca(data_sensors45, 'NumComponents', 2);
figure(9),
scatter(Z45(:,1), Z45(:,2), 25, y45,'filled');

% Cargamos datos del vial 4 y 5
% Cargamos el archivo csv
filename6 = 'putty_sensors_data6(VIAL4Y5).csv';
data6 = readtable(filename6);

% Buscamos la filas vacias y las eliminamos
empty_rows6 = all(ismissing(data6), 2);
data6(empty_rows6, :) = [];

new_filename6 = 'cleaned_putty_Arduino_Data6(VIAL4Y5).csv';
writetable(data6, new_filename6);
M6 = readmatrix('cleaned_putty_Arduino_Data6(VIAL4Y5).csv');

figure(10),
plot(data6{2:end, 1});
hold on
plot(data6{2:end, 2});
hold on
plot(data6{2:end, 3});



xline(5100); %%
xline(10200); %%

xline(15550); %%
xline(20650); %%

xline(23560); %%
xline(28660); %%

xline(33500); %%
xline(38600); %%

xline(41505); %%
xline(46605); %%

xline(51670); %%
xline(56770); %%

xline(59050); %%
xline(64150); %%

xline(69370); %%
xline(74470); %5

xline(79310); %%
xline(84410); %%

xline(89000); %%
xline(94100); %%

xline(96530); %%
xline(101630); %%

xline(106400); %%
xline(111500); %%

xline(113750); %%
xline(118850); %%

xline(123950); %%
xline(129050); %%

xline(132000);
xline(137100);

xline(141735);
xline(146835);

data_sensors6 = [M6(5100:10200,1)' M6(5100:10200,2)' M6(5100:10200,3)'; %%
    M6(15550:20650,1)' M6(15550:20650,2)' M6(15550:20650,3)'; %%
    M6(23560:28660,1)' M6(23560:28660,2)' M6(23560:28660,3)'; %%
    M6(33500:38600,1)' M6(33500:38600,2)' M6(33500:38600,3)'; %%
    M6(41505:46605,1)' M6(41505:46605,2)' M6(41505:46605,3)'; %%
    M6(51670:56770,1)' M6(51670:56770,2)' M6(51670:56770,3)'; %%
    M6(59050:64150,1)' M6(59050:64150,2)' M6(59050:64150,3)'; %%
    M6(69370:74470,1)' M6(69370:74470,2)' M6(69370:74470,3)'; %%
    M6(79310:84410,1)' M6(79310:84410,2)' M6(79310:84410,3)'; %%
    M6(89000:94100,1)' M6(89000:94100,2)' M6(89000:94100,3)'; %%
    M6(106400:111500,1)' M6(106400:111500,2)' M6(106400:111500,3)'; %%
    M6(113750:118850,1)' M6(113750:118850,2)' M6(113750:118850,3)'; %%
    M6(123950:129050,1)' M6(123950:129050,2)' M6(123950:129050,3)'; %%
    M6(132000:137100,1)' M6(132000:137100,2)' M6(132000:137100,3)';
    M6(141735:146835,1)' M6(141735:146835,2)' M6(141735:146835,3)';
];

y6 = [1 0 1 0 1 0 1 0 1 0 1 0 1 0 1];

[U6, Z6] = pca(data_sensors6, 'NumComponents', 2);
figure(11),
scatter(Z6(:,1), Z6(:,2), 25, y6,'filled');

% Cargamos datos8

% Cargamos el archivo csv
filename8 = 'putty_sensors_data8(VIAL1Y2).csv';
data8 = readtable(filename8);

% Buscamos la filas vacias y las eliminamos
empty_rows8 = all(ismissing(data8), 2);
data8(empty_rows8, :) = [];

new_filename8 = 'cleaned_putty_Arduino_Data8(VIAL1Y2).csv';
writetable(data8, new_filename8);
M8 = readmatrix('cleaned_putty_Arduino_Data8(VIAL1Y2).csv');

figure(12),
plot(data8{2:end, 1});
hold on
plot(data8{2:end, 2});
hold on
plot(data8{2:end, 3});

xline(6790);
xline(11890);

xline(16900);
xline(22000);

xline(24430);
xline(29530);

xline(34560);
xline(39660);

xline(42170);
xline(47270);

xline(52220);
xline(57320);

xline(59880);
xline(64980);

xline(111860);
xline(116960);

xline(121770);
xline(126870);

xline(129510);
xline(134610);

xline(139615);
xline(144715);

xline(147215);
xline(152315);

xline(157225);
xline(162325);

xline(164850);
xline(169950);

xline(175030);
xline(180130);

xline(205700);
xline(210800);

xline(215860);
xline(220960);

xline(223370);
xline(228470);

xline(233430);
xline(238530);

xline(241100);
xline(246200);

data_sensors8 = [M8(6790:11890,1)' M8(6790:11890,2)' M8(6790:11890,3)'; %%
    M8(16900:22000,1)' M8(16900:22000,2)' M8(16900:22000,3)'; %%
    M8(24430:29530,1)' M8(24430:29530,2)' M8(24430:29530,3)'; %%
    M8(34560:39660,1)' M8(34560:39660,2)' M8(34560:39660,3)'; %% 
    M8(42170:47270,1)' M8(42170:47270,2)' M8(42170:47270,3)'; %%
    M8(52220:57320,1)' M8(52220:57320,2)' M8(52220:57320,3)'; %% 
    M8(59880:64980,1)' M8(59880:64980,2)' M8(59880:64980,3)'; %%
    M8(111860:116960,1)' M8(111860:116960,2)' M8(111860:116960,3)'; %% 
    M8(121770:126870,1)' M8(121770:126870,2)' M8(121770:126870,3)'; %% 
    M8(129510:134610,1)' M8(129510:134610,2)' M8(129510:134610,3)'; %%
    M8(139615:144715,1)' M8(139615:144715,2)' M8(139615:144715,3)'; %%
    M8(147215:152315,1)' M8(147215:152315,2)' M8(147215:152315,3)'; %% 
    M8(157225:162325,1)' M8(157225:162325,2)' M8(157225:162325,3)'; %% 
    M8(164850:169950,1)' M8(164850:169950,2)' M8(164850:169950,3)'; %%
    M8(175030:180130,1)' M8(175030:180130,2)' M8(175030:180130,3)'; %%
    M8(205700:210800,1)' M8(205700:210800,2)' M8(205700:210800,3)'; %%
    M8(215860:220960,1)' M8(215860:220960,2)' M8(215860:220960,3)'; %%
    M8(223370:228470,1)' M8(223370:228470,2)' M8(223370:228470,3)'; %%
    M8(233430:238530,1)' M8(233430:238530,2)' M8(233430:238530,3)'; %%
    M8(241100:246200,1)' M8(241100:246200,2)' M8(241100:246200,3)';

];

y8 = [1 0 1 0 1 0 1 1 0 1 0 1 0 1 0 1 0 1 0 1];

[U8, Z8] = pca(data_sensors8, 'NumComponents', 2);
Y8 = tsne(data_sensors8);
figure(13),
scatter(Z8(:,1), Z8(:,2), 25, y8,'filled');
figure(14),
scatter(Y8(:,1), Y8(:,2), 25, y8, 'filled');

% Cargamos datos9
% Cargamos el archivo csv
filename9 = 'putty_sensors_data9.csv';
data9 = readtable(filename9);

% Buscamos la filas vacias y las eliminamos
empty_rows9 = all(ismissing(data9), 2);
data9(empty_rows9, :) = [];

new_filename9 = 'cleaned_putty_Arduino_Data9.csv';
writetable(data9, new_filename9);
M9 = readmatrix('cleaned_putty_Arduino_Data9.csv');

figure(15),
plot(data9{2:end, 1});
hold on
plot(data9{2:end, 2});
hold on
plot(data9{2:end, 3});

%Acetona
xline(21200);
xline(31200);

xline(31210);
xline(41210);

xline(41220);
xline(51220);

xline(51230);
xline(61230);

xline(61240);
xline(71240);

xline(71250);
xline(81250);

%Etanol
xline(81260);
xline(91260);
 
xline(91270);
xline(101270);
 
xline(101280);
xline(111280);
 
xline(111290);
xline(121290);
 
xline(121300);
xline(131300);
 
xline(130000);
xline(140000);

%Acetona
xline(140010);
xline(150010);
 
xline(150020);
xline(160020);
 
xline(160030);
xline(170030);

xline(170040);
xline(180040);

xline(180050);
xline(190050);

xline(190060);
xline(200060);

%Etanol
xline(200070);
xline(210070);

xline(210080);
xline(220080);

xline(220090);
xline(230090);

xline(230100);
xline(240100);

xline(240110);
xline(250110);


data_sensors9 = [M9(21200:31200,1)' M9(21200:31200,2)' M9(21200:31200,3)'; %%
    M9(31210:41210,1)' M9(31210:41210,2)' M9(31210:41210,3)'; %%
    M9(41220:51220,1)' M9(41220:51220,2)' M9(41220:51220,3)'; %% 
    M9(51230:61230,1)' M9(51230:61230,2)' M9(51230:61230,3)'; %% 
    M9(61240:71240,1)' M9(61240:71240,2)' M9(61240:71240,3)'; %%
    M9(71250:81250,1)' M9(71250:81250,2)' M9(71250:81250,3)'; %%  
    M9(140010:150010,1)' M9(140010:150010,2)' M9(140010:150010,3)'; %%
    M9(150020:160020,1)' M9(150020:160020,2)' M9(150020:160020,3)'; %%  
    M9(160030:170030,1)' M9(160030:170030,2)' M9(160030:170030,3)'; %%  
    M9(170040:180040,1)' M9(170040:180040,2)' M9(170040:180040,3)'; %%
    M9(180050:190050,1)' M9(180050:190050,2)' M9(180050:190050,3)'; %% 
    M9(190060:200060,1)' M9(190060:200060,2)' M9(190060:200060,3)'; %%

    M9(81260:91260,1)' M9(81260:91260,2)' M9(81260:91260,3)'; %%  <----
    M9(91270:101270,1)' M9(91270:101270,2)' M9(91270:101270,3)'; %% 
    M9(101280:111280,1)' M9(101280:111280,2)' M9(101280:111280,3)'; %% 
    M9(111290:121290,1)' M9(111290:121290,2)' M9(111290:121290,3)'; %% 
    M9(121300:131300,1)' M9(121300:131300,2)' M9(121300:131300,3)'; %% 
    %M9(130000:140000,1)' M9(130000:140000,2)' M9(130000:140000,3)'; %%MAL
    M9(200070:210070,1)' M9(200070:210070,2)' M9(200070:210070,3)'; %% 
    M9(210080:220080,1)' M9(210080:220080,2)' M9(210080:220080,3)'; %%
    M9(220090:230090,1)' M9(220090:230090,2)' M9(220090:230090,3)';
    M9(230100:240100,1)' M9(230100:240100,2)' M9(230100:240100,3)'; %%
    M9(240110:250110,1)' M9(240110:250110,2)' M9(240110:250110,3)';
];

y9 = [1 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0];

[U9, Z9] = pca(data_sensors9, 'NumComponents', 3);
figure(16),
scatter(Z9(:,1), Z9(:,3), 25, y9,'filled');

[idx,C] = kmeans(Z9,2);
figure(17),
gscatter(Z9(:,1),Z9(:,3),idx,'bgm')
hold on
plot(C(:,1),C(:,3),'kx')
% data10 = [];
% data10 = [data10 M9(81260:91260,1)' M9(81260:91260,2)' M9(81260:91260,3)';
%     M9(190060:200060,1)' M9(190060:200060,2)' M9(190060:200060,3)';];
% 
% [U10, Z10] = pca(data10, 'NumComponents', 2);
% figure(17),
% %plot(data10)
% scatter(Z10(1,:), Z10(2,:), 25,'filled');


